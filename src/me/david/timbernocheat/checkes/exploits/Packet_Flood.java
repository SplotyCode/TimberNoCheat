package me.david.timbernocheat.checkes.exploits;

import com.comphenix.protocol.events.PacketEvent;
import me.david.timbernocheat.TimberNoCheat;
import me.david.timbernocheat.checkmanager.Category;
import me.david.timbernocheat.checkmanager.Check;
import me.david.timbernocheat.checkmanager.PlayerData;

public class Packet_Flood extends Check {

    private final long delay;
    public Packet_Flood(){
        super("Packet_Flood", Category.EXPLOITS);
        delay = getLong("delay");
        inctance = this;
    }

    /*
    check is registet in NBT class
     */
    public static void check(PacketEvent e){
        PlayerData pd = TimberNoCheat.checkmanager.getPlayerdata(e.getPlayer());
        long delay = pd.getLastnbtpacket()-System.currentTimeMillis();
        if(delay < inctance.delay){
            inctance.updatevio(inctance, e.getPlayer(), 1, " ยง6DELAY: ยงb" + delay);
            e.setCancelled(true);
        }
        pd.setLastnbtpacket(System.currentTimeMillis());
    }
    private static Packet_Flood inctance;
}
