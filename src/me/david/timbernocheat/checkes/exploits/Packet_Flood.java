package me.david.timbernocheat.checkes.exploits;

import com.comphenix.protocol.events.PacketEvent;
import me.david.timbernocheat.checkbase.Category;
import me.david.timbernocheat.checkbase.Check;
import me.david.timbernocheat.checkbase.CheckManager;
import me.david.timbernocheat.checkbase.PlayerData;

public class Packet_Flood extends Check {

    private final long delay;
    public Packet_Flood(){
        super("Packet_Flood", Category.EXPLOITS);
        delay = getLong("delay");
        inctance = this;
    }

    /*
     * Check is called in NBT class
     */
    public static void check(PacketEvent event){
        PlayerData pd = CheckManager.getInstance().getPlayerdata(event.getPlayer());
        long delay = pd.getLastNBTPacket()-System.currentTimeMillis();
        if(delay < inctance.delay){
            if(inctance.updateVio(inctance, event.getPlayer(), 1, " ยง6DELAY: ยงb" + delay))
                event.setCancelled(true);
        }
        pd.setLastNBTPacket(System.currentTimeMillis());
    }

    private static Packet_Flood inctance;
}
