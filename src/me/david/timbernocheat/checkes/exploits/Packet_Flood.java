package me.david.timbernocheat.checkes.exploits;

import com.comphenix.protocol.events.PacketEvent;
import me.david.timbernocheat.TimberNoCheat;
import me.david.timbernocheat.checkbase.Category;
import me.david.timbernocheat.checkbase.Check;
import me.david.timbernocheat.checkbase.PlayerData;

public class Packet_Flood extends Check {

    private final long delay;
    public Packet_Flood(){
        super("Packet_Flood", Category.EXPLOITS);
        delay = getLong("delay");
        inctance = this;
    }

    /*
     * Check is called in NBT class
     */
    public static void check(PacketEvent e){
        PlayerData pd = TimberNoCheat.getCheckManager().getPlayerdata(e.getPlayer());
        long delay = pd.getLastnbtpacket()-System.currentTimeMillis();
        if(delay < inctance.delay){
            if(inctance.updateVio(inctance, e.getPlayer(), 1, " ยง6DELAY: ยงb" + delay))
                e.setCancelled(true);
        }
        pd.setLastnbtpacket(System.currentTimeMillis());
    }

    private static Packet_Flood inctance;
}
